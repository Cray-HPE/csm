#!/bin/sh
# Copyright 2021 Hewlett Packard Enterprise Development LP

TARGET_FILE=$1
YQ=$2

[ -z "$TARGET_FILE" ] && exit 1
[ -z "$YQ" ] && exit 1

cat <<EOF | $YQ w -i -s - $TARGET_FILE
- command: delete
  path: spec.network.static_ips.dns.system_to_site_lookups
- command: delete
  path: spec.kubernetes.services.cray-dns-unbound.forwardZones
- command: update
  path: spec.kubernetes.services.cray-dns-unbound
  value:
    localZones:
    - name: "local"
      localType: static
    - name: "."
      localType: static
EOF
